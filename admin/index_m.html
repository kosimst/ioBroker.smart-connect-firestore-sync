<html>
    <head>
        <!-- Load ioBroker scripts and styles-->
        <link rel="stylesheet" type="text/css" href="../../css/adapter.css" />
        <link rel="stylesheet" type="text/css" href="../../lib/css/materialize.css" />

        <script type="text/javascript" src="../../lib/js/jquery-3.2.1.min.js"></script>
        <script type="text/javascript" src="../../socket.io/socket.io.js"></script>

        <script type="text/javascript" src="../../js/translate.js"></script>
        <script type="text/javascript" src="../../lib/js/materialize.js"></script>
        <script type="text/javascript" src="../../js/adapter-settings.js"></script>

        <!-- Load our own files -->
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script type="text/javascript" src="words.js"></script>
        <script type="module">
            let settings;

            window.load = function load(currentSettings, onChange) {
                if (!currentSettings) return;
                onChange(false);

                settings = currentSettings;

                const serviceAccountInput = document.getElementById('service-account');
                serviceAccountInput.value = JSON.stringify(settings.serviceAccount);
                serviceAccountInput.onkeypress = ({ target: { value } }) => {
                    try {
                        settings.serviceAccount = JSON.parse(value);
                        onChange();
                    } catch {}
                };

                const jsonInput = document.getElementById('json-overwrite');
                jsonInput.onkeypress = ({ target: { value } }) => {
                    try {
                        settings.jsonOverwrite = JSON.parse(value);
                        onChange();
                    } catch {}
                };

                const usedConfigInput = document.getElementById('used-config');
                usedConfigInput.value = JSON.stringify(settings.usedConfig);
            };

            window.save = function save(callback) {
                callback(settings);
            };
        </script>
    </head>

    <body>
        <div class="m adapter-container">
            <!-- For example columns with settings: -->
            <br />
            <div class="row">
                <div class="col s6 input-field">
                    <input type="text" class="value" id="service-account" placeholder="Firebase service account..." />
                    <label for="service-account" class="translate">Service Account</label>
                </div>
                <div class="col s6 input-field">
                    <input type="text" class="value" id="json-overwrite" placeholder="JSON Overwrite" />
                    <label for="json-overwrite" class="translate">JSON Overwrite</label>
                </div>
            </div>

            <br />
            <hr />
            <br />

            <div class="row">
                <div class="col s12 input-field">
                    <input type="text" class="value" id="used-config" disabled />
                    <label for="used-config" class="translate">Used Config</label>
                </div>
            </div>
        </div>
    </body>
</html>
